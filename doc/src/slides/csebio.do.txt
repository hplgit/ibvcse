# Slides for FYS-KJM4480
TITLE: Integrating computations, mathematics, physics and chemistry in undergraduate biology programs
AUTHOR: Morten Hjorth-Jensen and Hans Petter Langtangen, Computing in Science Education, University of Oslo
DATE: October 12 2014

!split
===== Overarching questions =====

!bblock 
* What kind of education do we want to give our undergraduate students and which skills are needed by biology students? 
* Can we integrate programming, computations, mathematics and topics from physical sciences like physics and chemistry, in a seamless way in the basic biology (including all subdisciplines at IBV) education? 
* Do we need to teach mathematics, physics, computations, chemistry etc as separate topics/courses, often totally disconnected from the interests and the needs of biology students and their teachers? 
* Can we teach these topics in such a way that we can develop a better intuition and understanding of say computations and mathematics? And topics from other disciplines as well.
* Would a problem based education suit better the needs of undergraduate programs in biology?
* Would it be appropriate to  simply label all courses the first two-years of study as BIO-xxx?  
* Can this serve as a model for other undergraduate programs as well? 
!eblock


!split
===== Possible pilot project =====

!bblock 
* Set up a team of dedicated teachers (biology and CSE oriented people from other disciplines) and PhD, MSc and undergraduate students that will develop examples of topics to integrate  in biology courses.  
* The recently established CINPLA@IBV project (Endringsmiljoe at MN@UiO) has hired four PhD students for four years. These PhD students can as part of their teaching duties develop several examples for biology courses  that integrate math and computations.  
* The PhD students can form the hard core of the working group, in close collaboration with teachers from IBV and other CSE teachers and MSc and undergraduate students supported by the CSE project.
* The duration of the project could be one year, with the final aim to develop a series of cases to present at an education workshop at IBV.
* These cases will form the basis for a workshop next year for teachers at IBV, with an emphasis on integrating computations and math. 
* The exit of this workshop can pave the road for step two, namely developing undergraduate modules that integrate several disciplines in biology courses. 
* Time-line: one to two years to develop the first integrated pilot.
!eblock




!split 
===== Develop a PBL based first year in Biology  ===== 
!bblock Aim: introduce the relevant mathematics and computations in order to develop student intuition about the scientific method 

* Typical situation is that math courses are taught in a traditional way. Standard situation: after some few preliminary words about the relevance and possible examples, the main emphasis is on the mathematical properties of the equations, their solutions, uniqueness etc etc. 
* This if often disconnected from the background of students in a particular undergraduate program
* Similarly, topics like writing a program, reading data from file, plotting etc are normally taught in a disconnected course on programming. 
* How can we change this?
* Integrate mathematics, computations and other disciplines in biology courses. The mathematical models, relevant physics/chemistry and other topics are introduced in a coherent way in biology courses. 
!eblock


!split 
===== Examples: *Predator-Prey* model  ===== 
!bblock Lotka-Volterra model and data from Hudson bay
The population dynamics of a simple predator-prey system  is a classical example shown in many biology textbooks when ecological systems are discussed. The system contains all elements of the scientific method, starting with an emphasis on

 * The set up of a specific hypothesis combined with
 * the experimental methods needed (one can study existing data or perform experiments),
 * analyzing and interpreting the data and performing further experiments if needed
 * trying to extract general behaviors and extract eventual laws or patterns. 
 * develop eventual mathematical relations for the uncovered regularities/laws and test these by performing new experiments
!eblock


!split 
===== Examples: *Predator-Prey* model  ===== 
!bblock Lotka-Volterra model and data from Hudson bay

 * In this example we start with the data on hares and lynx collected from furs in Canada. The data show distinct oscillations.
 * The first step in the scientific investigation is thus to plot these data, introducing thereby simple programming issues like what is a file, how do I read from a file and how do I plot the data. When analyzing these data from a biological standpoint one can then integrate the first steps in programming. 
 * The next step is to try to model these data by simple finite difference equations. These equations provide an intuitive way to introduce mathematics. At later stages one can replace these difference equations with differential equations. 
 * The equations will also contain parameters which can fitted by using the data. At a later stage one can introduce tools like least-square fitting (this can come later)
 * This model can then be extended to models for the spread of diseases. 
 * And obviously, can the model which has been developed be applied to other predator-prey systems?

With these steps one can then encompass significant elements of the scientific method at a very early stage in the educational ladder (first year), bringing in elements from computations, mathematics and statistics  in a natural and problem-based way. 
!eblock





!split
===== Hudson bay data =====

!bblock First step: the data

Most mammalian predators rely on a variety of prey, which complicates mathematical modeling; however, a few predators have become highly specialized and seek almost exclusively a single prey species. An example of this simplified predator-prey interaction is seen in Canadian northern forests, where the populations of the lynx and the snowshoe hare are intertwined in a life and death struggle.

One reason that this particular system has been so extensively studied is that the Hudson Bay company kept careful records of all furs from the early 1800s into the 1900s. The records for the furs collected by the Hudson Bay company showed distinct oscillations (approximately 12 year periods), suggesting that these species caused almost periodic fluctuations of each other's populations. The table here shows data from 1900 to 1920. 

|------------------------------------------------------|
|      Year         |     Hares (x1000)  | Lynx (x1000)|
|---------l-----------------------r--------------r------|
|  1900 | 30.0  | 4.0  |
|  1901 | 47.2  | 6.1 |
|  1902 | 70.2  | 9.8  |
|  1903 | 77.4  | 35.2  |
|  1904 | 36.3  | 59.4  |
|  1905 | 20.6  | 41.7  |
|  1906 | 18.1  | 19.0  |
|  1907 | 21.4  | 13.0  |
|  1908 | 22.0  | 8.3  |
|  1909 | 25.4  | 9.1  |
|  1910 | 27.1  | 7.4 |
|  1911 | 40.3  | 8.0  |
|  1912 | 57  | 12.3  |
|  1913 | 76.6  | 19.5  |
|  1914 | 52.3  | 45.7  |
|  1915 | 19.5  | 51.1  |
|  1916 | 11.2  | 29.7  |
|  1917 | 7.6  | 15.8  |
|  1918 | 14.6  | 9.7  |
|  1919 | 16.2  | 10.1  |
|  1920 | 24.7  | 8.6  |
|------------------------------------------------------|

!eblock


!split 
===== Example of possible cases, *Predator-Prey* model  ===== 
!bblock 
The first step is now to 
 
* make a file which contains the data, with columns containing year and data on hares and lynx. This will teach students the concept of a file and introduce practicalities like using terminals and editors.
 * The next step is to teach the first basic programming elements, including things like what is a program, files, reading from file and plotting.  The aim is to now to read the above data and plot them, exemplified here in a simple python (we recommend python as the programming language) program. The program uses the *matplotlib* package. 
!bc  pycod
from numpy import *
from pylab import *
from matplotlib import rc, rcParams
import matplotlib.units as units
import matplotlib.ticker as ticker
import sys
import os
import matplotlib.pyplot as plt
import numpy as np

rc('text',usetex=True)
rc('font',**{'family':'serif','serif':['Separation energy for nickel isotopes']})
title(r'{\bf Population of hares and lynx from 1900 to 1920 (x1000)}', fontsize=20)     
# Load in data file
popdata = loadtxt("popdata.dat")
# Make arrays containing x-axis and hares and lynx populations
year = popdata[:,0]
hares = popdata[:,1]
lynx = popdata[:,2]  
axis([1895,1925,0, 100.0])
# Put lables on axes
xlabel(r'Year',fontsize=20)
ylabel(r'Numbers of hares and lynx ',fontsize=20)
# Then plot
plot(year, hares ,'b-*',   year, lynx, 'r:.',  markersize=7)
legend(('Hares','Lynx'),
           'upper right', shadow=False, fancybox=False,prop={"size":18})
legend(loc='upper right')
savefig('popdata.pdf', format='pdf')

show()
# When running with ipython notebook, uses the --pylab inline option to get the figure in the ipython notebook
!ec
A very useful addendum here is to provide the students with information on how to use *ipython notebook*. Handing material in this format, will allow students to make their own electronic notebooks, change the text, add, improve upon, do exercises etc etc.
!eblock

!split
===== Hares and lynx in Hudson bay from 1900 to 1920 =====

FIGURE: [popdata.pdf, width=500 frac=0.6]


!split 
===== Example of possible cases, *Predator-Prey* model  ===== 
!bblock 
We see from the plot that there are indeed fluctuations. 

We would like to create a mathematical model that explains these population fluctuations. Ecologists have predicted that in a simple predator-prey system that a rise in prey population is followed (with a lag) by a rise in the predator population. When the predator population is sufficiently high, then the prey population begins dropping. After the prey population falls, then the predator population falls, which allows the prey population to recover and completes one cycle of this interaction. Thus, we see that qualitatively oscillations occur. Can a mathematical model predict this? What causes cycles to slow or speed up? What affects the amplitude of the oscillation or do you expect to see the oscillations damp to a stable equilibrium? The models tend to ignore factors like climate and other complicating factors. How significant are these?   

* The top-down approach would  with the Lotka-Volterra equation and discuss how to solve it. The equation expresses the population changes through time according to the pair of equations:
!bt
\[
\frac{dx}{dt} = x(\alpha - \beta y)\\
\frac{dy}{dt} = - y(\gamma - \delta  x)
\]
!et 
* Here $x$ is the number of preys and $y$ the number of predators. The other variables describe the interactions between the two species.
* The rates $dx/dt$ and $dy/dt$ represent the growth rates over time.
* The equation is then used to link mathematical modeling with   experimental data, here  hares and lynx in Canada.
!eblock


!split 
===== Example of possible cases, *Predator-Prey* model, the bottom-up approach  ===== 
!bblock 
* The bottom-up approach: start with experimental data and discuss the methods which have been used to collect the data, the assumptions, the aims etc. That is, expose the students to the general thinking  why these data have been collected and motivate for the scientific method. 
* Where appropriate the students should do the experiment(s) needed to collect the data.
* The first programming tasks would then be taught together with the data collection process, with an emphasis on reading and writing data to/from file and making plots of the data (develops the concept of a graph, here discrete function in time and setting up units).
* The students can then be triggered to see if they, from the plotted data, can discover patterns or regularities. This strengthens a research-driven intuition development. 
!eblock


!split 
===== Example of possible cases, *Predator-Prey* model, the bottom-up approach  ===== 
!bblock 
* After the first programming experience with reading and writing to/from file and plotting data, it is time to start modeling the data.
* The simplest possibility is to forward a hypothesis based on changes in time of the populations, setting the problem up  as  intuitive difference equations.
* We introduce also the concept of a function of time. Here we label the number of hares as function of time as $H(t)$ and the number of lynx as $L(t)$. 
* The change in the population of hares from year $t$ to a year $t+\Delta t$ (where $\Delta t$ is the change) is then given by 
!bt
\[
H(t+\Delta t)-H(t),
\]
!et
The rate by which this quantity changes as function of time is then simply given by the change in hares divided by the change in time, that is we have
!bt
\[
\frac{H(t+\Delta t)-H(t)}{\Delta t}.
\]
!et
We have a similar equation for the number of lynx, namely
!bt
\[
\frac{L(t+\Delta t)-L(t)}{\Delta t}.
\]
!et
!eblock

!split 
===== Example of possible cases, *Predator-Prey* model, the bottom-up approach  ===== 
!bblock Analysis stage
With the rates by which the populations of hares and lynx change, we can now start modeling their interactions.

* We have now the so-called initial values (initial conditions), that is, if we use the year 1900 as year zero, then we have from the above table
!bt
\[
H(t=0) =  30, 
\]
!et
and
!bt
\[
L(t=0) =  4. 
\]
!et
We assume that the rate of change in a population is equal to the net increase (births) into the population minus the net decrease (deaths) of the population.
In making our model, we assume that the hares grow in proportion to their own population, that is, without lynx we can assume that
!bt
\[
\frac{H(t+\Delta t)-H(t)}{\Delta t}=\alpha H(t),
\]
!et
where $\alpha$ is a constant to be determined. 
We assume then that the primary loss of hares is due to predation by lynx. We model the latter as an interaction between hares and lynx by adding  a negative term
!bt
\[
\frac{H(t+\Delta t)-H(t)}{\Delta t}=\alpha H(t)-\beta H(t)L(t),
\]
!et
where $\beta$ is another constant to be determined. 

!eblock


!split 
===== Example of possible cases, *Predator-Prey* model, the bottom-up approach  ===== 
!bblock 

For the time development of the lynx population, we assume that the primary growth for the lynx population depends on sufficient food for raising lynx kittens, which implies an adequate source of nutrients from predation on hares. Thus, the growth of the lynx population is similar to the death rate for the hare population with a different constant of proportionality. We model as an interaction between hares and lynx as
!bt
\[
\frac{L(t+\Delta t)-L(t)}{\Delta t}=\gamma L(t)H(t),
\]
!et
where $\gamma$ is a constant to be determined. 
We assume then that the primary loss of lynx is due to declines in their own population, leading then to the following growth rate
!bt
\[
\frac{L(t+\Delta t)-L(t)}{\Delta t}=\gamma L(t)H(t)-\delta L(t),
\]
!et
with $\delta$ being another constant to be determined. 

!eblock


!split 
===== Example of possible cases, *Predator-Prey* model, the bottom-up approach  ===== 
!bblock 

In summary we have the initial conditions
!bt
\[
H(t=0) =  30, 
\]
!et
and
!bt
\[
L(t=0) =  4,
\]
!et
and the following two coupled equations
!bt
\[
\frac{H(t+\Delta t)-H(t)}{\Delta t}=\alpha H(t)-\beta H(t)L(t),
\]
!et
and
!bt
\[
\frac{L(t+\Delta t)-L(t)}{\Delta t}=\gamma L(t)H(t)-\delta L(t).
\]
!et
These equations have four parameters $\alpha\beta\gamma\delta$ which encompass complicated dynamics between the species and the environment. In the first stage, the students should be given values for these parameters, with an explanation that at a later 
stage we will show them how to determine these parameters. 


!eblock


!split 
===== Example of possible cases, *Predator-Prey* model, the bottom-up approach  ===== 
!bblock 

* The next step now is to write a program which, with the given initial conditions, solves these two equations from an initial time
$t_0$ to a given final time. 

* Since data are given in terms of years, this means that the first approach should have $\Delta t=1$ yr in
!bt
\[
\frac{H(t+\Delta t)-H(t)}{\Delta t}=\alpha H(t)-\beta H(t)L(t),
\]
!et
and
!bt
\[
\frac{L(t+\Delta t)-L(t)}{\Delta t}=\gamma L(t)H(t)-\delta L(t).
\]
!et
In this model, the students could try to solve these equations by using 1900 as starting year and 1920 as the final year. 

* The program will be rather simple but contains important elements like function constructions, loops, if statements and the definition of one-dimensional arrays which contain the solutions as function of time. 

* With the first project where students are asked to make a file containing the data and plot them, the next project is actually to write a program with the above elements and test the model. 

* Hans Petter, skal vi legge til et program?  Vil det kunne vaere nyttig for diskusjonen? Jeg kan skrive et enkelt python program her, hvor vi demonstrerer dette. 

!eblock


!split 
===== Example of possible cases, *Predator-Prey* model, the bottom-up approach  ===== 
!bblock Next steps
* There are several further paths which can be followed.
 * Include a model for diseases among the predators
 * Bring concepts from statistics and discuss how to possibly make fits of the data in order to constrain the parameters $\alpha\beta\gamma\delta$. *We need to figure out if this is premature*.
 * Move from difference equations to differential equations, would this be meaningful?  
!eblock




!split 
===== Example of possible cases, Genomics  ===== 
!bblock 
* Skal vi si noe om dette ogsaa eller holder det? Her kan vi snakke om feks enkle Markov DNA sekvenser
!eblock
